--Question 6:Find the player who had the most success stealing bases in 2016, where __success__ is measured as the percentage of 
--stolen base attempts which are successful. (A stolen base attempt results either in a stolen base or being caught stealing.) 
--Consider only players who attempted _at least_ 20 stolen bases.

SELECT namefirst,namelast, sb, cs, ROUND ((SUM(sb::numeric)/(SUM(sb::numeric)+SUM(cs::numeric))*100),2)
FROM people LEFT JOIN batting USING (playerid)
WHERE yearid=2016
GROUP BY namefirst,namelast, sb, cs
HAVING SUM(sb)+SUM(cs)>=20
ORDER BY ((SUM(sb::numeric)/(SUM(sb::numeric)+SUM(cs::numeric))*100),2) DESC

SELECT namefirst,namelast, sb, cs, ROUND ((SUM(sb::numeric)/(SUM(sb::numeric)+SUM(cs::numeric))*100),2)
FROM people INNER JOIN batting USING (playerid)
WHERE yearid=2016
GROUP BY namefirst,namelast, sb, cs
HAVING SUM(sb)+SUM(cs)>=20
ORDER BY ((SUM(sb::numeric)/(SUM(sb::numeric)+SUM(cs::numeric))*100),2) DESC