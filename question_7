--7.  From 1970 – 2016, what is the largest number of wins for a team that did not win the world series? 
--What is the smallest number of wins for a team that did win the world series? Doing this will probably 
--result in an unusually small number of wins for a world series champion – determine why this is the case.
--Then redo your query, excluding the problem year. How often from 1970 – 2016 was it the case that a team with the
--most wins also won the world series? What percentage of the time?

1970-2016
find teams who did not win world series
order by the number with the highest total wins

Find the teams that did win wold series
order by team with LOWEST/ min amount of wins

Identify the problem year
 Intersect of/ AND top wins AND won the world series
compute to percentage.

------ From 1970 – 2016, what is the largest number of wins for a team that did not win the world series? 116

SELECT wswin,
       name,
	   yearid,
	   g, 
      SUM(w)
FROM teams
WHERE wswin='N'
AND yearid BETWEEN 1970 AND 2016
GROUP BY wswin,
       name,
	   yearid,
	   g
ORDER BY SUM (w) DESC

--What is the smallest number of wins for a team that did win the world series? Doing this will probably 
--result in an unusually small number of wins for a world series champion – determine why this is the case.
-- 1981 had 63 wins - a strik in MLB
SELECT wswin,
       name,
	   yearid,
	   g, 
      SUM(w)
FROM teams
WHERE wswin='Y'
AND yearid BETWEEN 1970 AND 2016
GROUP BY wswin,
       name,
	   yearid,
	   g
ORDER BY SUM (w)

--Then redo your query, excluding the problem year. How often from 1970 – 2016 was it the case that a team with the
--most wins also won the world series? What percentage of the time?

SELECT wswin,
       name,
	   yearid,
	   g, 
      SUM(w)
FROM teams
WHERE wswin='Y'
AND yearid BETWEEN 1970 AND 2016
AND yearid <>1981
GROUP BY wswin,
       name,
	   yearid,
	   g
ORDER BY SUM (w)

WITH teams (SELECT wswin,
				   name,
				   yearid,
				   g, 
				  SUM(w) as sum_wins
			FROM teams
			WHERE wswin='Y'
			AND yearid BETWEEN 1970 AND 2016
			AND yearid <>1981
			GROUP BY wswin,
				   name,
				   yearid,
				   g
			ORDER BY SUM (w))
SELECT *
FROM sum_win



